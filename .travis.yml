language: node_js
node_js:
  # - node # 10.X is currently broken due to deprecated Buffer in Yarn
  - "9"
  - "lts/*" # 8.X
cache:
  yarn: true
  directories:
    - node_modules
services:
  - postgresql
  - redis
before_install:
  - yarn global add greenkeeper-lockfile@1
before_script:
  - greenkeeper-lockfile-update
  - psql -c 'CREATE DATABASE udiadbtest;' -U postgres
after_script:
  - greenkeeper-lockfile-upload
  - cat ./coverage/lcov.info | ./node_modules/.bin/coveralls
env:
  global:
    - NODE_ENV=test
    - SQL_HOST=localhost
    - SQL_USER=postgres
    - SQL_PASSWORD=
    - SQL_DB=udiadbtest
    - SQL_TEST_DB=udiadbtest
    - SQL_PORT=5432
    - SQL_TEST_PORT=5432
    - PGPORT=5432
